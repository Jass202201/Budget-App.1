<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="p-4 bg-gray-100">
  <h1 class="text-2xl font-bold mb-4">Budget Tracker</h1>

  <div id="auth" class="flex flex-col gap-2">
    <input id="email" placeholder="Email" class="p-2 border rounded">
    <input id="password" type="password" placeholder="Password" class="p-2 border rounded">
    <button id="loginBtn" class="p-2 bg-blue-600 text-white rounded">Login / Signup</button>
  </div>

  <div id="app" class="hidden">
    <div class="mb-4">
      <input id="amount" type="number" placeholder="Amount" class="p-2 border rounded w-full mb-2">
      <input id="note" placeholder="Note" class="p-2 border rounded w-full mb-2">
      <select id="type" class="p-2 border rounded w-full mb-2">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>
      <button id="addBtn" class="p-2 bg-green-600 text-white rounded w-full">Add</button>
    </div>

    <h2 class="text-xl font-semibold mb-2">Entries</h2>
    <div id="list"></div>
  </div>

<script>
const firebaseConfig = {
  // paste your firebase config here
};
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

document.getElementById("loginBtn").onclick = async () => {
  const email = email.value;
  const pass = password.value;
  try {
    await auth.signInWithEmailAndPassword(email, pass);
  } catch {
    await auth.createUserWithEmailAndPassword(email, pass);
  }
};

auth.onAuthStateChanged(user => {
  if (!user) return;
  document.getElementById("auth").classList.add("hidden");
  document.getElementById("app").classList.remove("hidden");

  const list = document.getElementById("list");
  db.collection("entries")
    .where("user", "==", user.uid)
    .orderBy("time", "desc")
    .onSnapshot(snap => {
      list.innerHTML = "";
      snap.forEach(doc => {
        const d = doc.data();
        list.innerHTML += `<div class="p-2 mb-2 bg-white rounded">
          ${d.type.toUpperCase()}: $${d.amount} - ${d.note}
        </div>`;
      });
    });
});

document.getElementById("addBtn").onclick = () => {
  const user = auth.currentUser;
  db.collection("entries").add({
    user: user.uid,
    amount: Number(amount.value),
    note: note.value,
    type: type.value,
    time: Date.now()
  });
};
</script>

</body>
</html>